<section>
  <div class="mt-14 max-w-screen mx-auto px-6 w-full md:w-3/4 lg:w-2/3 xl:w-2/3">
    <div class="flex flex-row items-center py-4">
      <a
        [routerLink]="['/websites']"
        class="text-black dark:text-white hover:underline flex flex-row items-center gap-x-1">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-6 h-6 fill-black dark:fill-white">
        <path fill-rule="evenodd" d="M11.03 3.97a.75.75 0 0 1 0 1.06l-6.22 6.22H21a.75.75 0 0 1 0 1.5H4.81l6.22 6.22a.75.75 0 1 1-1.06 1.06l-7.5-7.5a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 0 1 1.06 0Z" clip-rule="evenodd" />
      </svg>
        Back to Websites</a>
    </div>
  </div>
  <div class="px-2">
    <div
      id="website-header"
      class="flex items-stretch flex-col grow shrink justify-start max-w-full">
      <div
        class="max-w-screen mx-auto px-6 w-full md:w-3/4 lg:w-2/3 xl:w-2/3 bg-white dark:bg-gray-800 rounded-md shadow-lg py-4">
        <div class="flex flex-col grow shrink justify-start max-w-full">
          <header>
            <div class="">
              <div
                class="flex items-stretch basis-auto flex-col flex-grow-0 shrink justify-start gap-0 sm:w-auto w-full">
                <div
                  class="flex items-stretch justify-start flex-col sm:flex-row shrink">
                  <div
                    class="flex items-stretch basis-auto flex-col justify-start gap-x-0 flex-grow-0 shrink">
                    <div
                      class="sm:mr-5 items-stretch flex basis-auto flex-col flex-grow-0 shrink justify-center">
                      <div
                        class="flex items-stretch basis-auto flex-col flex-grow-0 shrink justify-center gap-y-0">
                        <div
                          class="aspect-video overflow-hidden flex basis-auto shrink-0 flex-grow-0 justify-center border-neutral-300 bg-neutral-300 dark:border-gray-600 dark:bg-gray-600 border-solid rounded-md border-2 p-0">

                            <div *ngIf="!imageLoading" class="w-full h-full sm:max-w-96">
                              <img
                                src="{{ website.imageUrl }}"
                                alt="Website screenshot image"
                                class="w-full h-full object-cover"
                              />
                            </div>

                          <div *ngIf="imageLoading" class="flex justify-center items-center" >
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 24 24"
                              fill="white"
                              class="w-full">
                              <path
                                d="M21.721 12.752a9.711 9.711 0 0 0-.945-5.003 12.754 12.754 0 0 1-4.339 2.708 18.991 18.991 0 0 1-.214 4.772 17.165 17.165 0 0 0 5.498-2.477ZM14.634 15.55a17.324 17.324 0 0 0 .332-4.647c-.952.227-1.945.347-2.966.347-1.021 0-2.014-.12-2.966-.347a17.515 17.515 0 0 0 .332 4.647 17.385 17.385 0 0 0 5.268 0ZM9.772 17.119a18.963 18.963 0 0 0 4.456 0A17.182 17.182 0 0 1 12 21.724a17.18 17.18 0 0 1-2.228-4.605ZM7.777 15.23a18.87 18.87 0 0 1-.214-4.774 12.753 12.753 0 0 1-4.34-2.708 9.711 9.711 0 0 0-.944 5.004 17.165 17.165 0 0 0 5.498 2.477ZM21.356 14.752a9.765 9.765 0 0 1-7.478 6.817 18.64 18.64 0 0 0 1.988-4.718 18.627 18.627 0 0 0 5.49-2.098ZM2.644 14.752c1.682.971 3.53 1.688 5.49 2.099a18.64 18.64 0 0 0 1.988 4.718 9.765 9.765 0 0 1-7.478-6.816ZM13.878 2.43a9.755 9.755 0 0 1 6.116 3.986 11.267 11.267 0 0 1-3.746 2.504 18.63 18.63 0 0 0-2.37-6.49ZM12 2.276a17.152 17.152 0 0 1 2.805 7.121c-.897.23-1.837.353-2.805.353-.968 0-1.908-.122-2.805-.353A17.151 17.151 0 0 1 12 2.276ZM10.122 2.43a18.629 18.629 0 0 0-2.37 6.49 11.266 11.266 0 0 1-3.746-2.504 9.754 9.754 0 0 1 6.116-3.985Z" />
                            </svg>
                          </div>

                        </div>
                      </div>
                    </div>
                  </div>
                  <div
                    class="flex items-stretch justify-start flex-col basis-auto flex-grow flex-shrink gap-x-6 gap-y-3 py-4 sm:py-0">
                    <div class="flex flex-col sm:flex-row justify-between sm:items-start gap-y-4 gap-x-6">
                    <div
                      class="flex items-stretch flex-col sm:flex-row justify-between gap-x-6 gap-y-2 pt-1">
                      <p class="text-xl font-bold text-gray-900 dark:text-white sm:text-2xl">
                        Website Details
                      </p>
                      <mat-chip class="w-fit">
                        <span
                          class="text-sm font-medium text-white px-2 py-1"
                          aria-label="Website status"

                          >{{ website?.status }}</span
                        >
                      </mat-chip>
                    </div>
                    <div class="w-full sm:w-fit">
                      <button mat-flat-button class="w-full" color="warn" (click)="openDeleteDialog()">
                        Delete
                      </button>
                    </div>
                    </div>
                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">
                      <span class="font-bold">URL: </span>{{ website?.url }}
                    </p>
                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">
                      <span class="font-bold">Created at: </span>{{ website?.createdAt | date: 'MMM d, y, h:mm:ss a' }}
                    </p>
                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">
                      <span class="font-bold">Last Evaluation: </span>{{ website?.lastEvaluated ? (website.lastEvaluated | date: 'MMM d, y, h:mm:ss a') : 'Not evaluated yet' }}

                    </p>
                  </div>
                </div>
              </div>
            </div>
          </header>
        </div>
      </div>
    </div>

    <!-- Website Stats -->
    <div class="w-full md:w-3/4 lg:w-2/3 xl:w-2/3 mx-auto mt-10">
    <div>
      <dl class="mt-5 grid grid-cols-1 gap-5 sm:grid-cols-2">
        <div class="relative overflow-hidden rounded-lg bg-white dark:bg-gray-800 px-4 pb-5 pt-5 shadow-lg sm:px-6 sm:pt-6">
          <dt>
            <div class="absolute rounded-md bg-green-500 p-3">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 fill-white">
                <path fill-rule="evenodd" d="M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z" clip-rule="evenodd" />
              </svg>

            </div>
            <p class="ml-16 truncate text-sm font-medium text-gray-500 dark:text-gray-400">Pages Without Errors</p>
          </dt>
          <dd class="ml-16 flex items-baseline">
            <p class="text-2xl font-semibold text-gray-900 dark:text-white">{{ website.stats.
              pagesWithoutErrors }}</p>
            <p class="ml-2 flex items-baseline text-sm font-semibold text-green-600">
              <span class="sr-only"> Percentage </span>
              {{ website.stats.
                pagesWithoutErrors / website.stats.
                evaluatedPages * 100 | number: '1.0-0' }}%
            </p>

          </dd>
        </div>
        <div class="relative overflow-hidden rounded-lg bg-white dark:bg-gray-800 px-4 pb-5 pt-5 shadow-lg sm:px-6 sm:pt-6">
          <dt>
            <div class="absolute rounded-md bg-red-500 p-3">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6" fill="white">
                <path fill-rule="evenodd" d="M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
              </svg>
            </div>
            <p class="ml-16 truncate text-sm font-medium text-gray-500 dark:text-gray-400">Pages With Errors</p>
          </dt>
          <dd class="ml-16 flex items-baseline">
            <p class="text-2xl font-semibold text-gray-900 dark:text-white">{{ website.stats.
              pagesWithErrors }}</p>
            <p class="ml-2 flex items-baseline text-sm font-semibold text-green-600">
              <span class="sr-only"> Percentage </span>
              {{ website.stats.
                pagesWithErrors / website.stats.
                evaluatedPages * 100 | number: '1.0-0' }}%
            </p>
          </dd>
        </div>

      </dl>
    </div>
    </div>

    <!-- Website Error Type Stats -->
    <div class="w-full md:w-3/4 lg:w-2/3 xl:w-2/3 mx-auto">
    <div>
      <dl class="mt-10 grid grid-cols-1 divide-y divide-gray-200 dark:divide-gray-600 overflow-hidden rounded-lg bg-white dark:bg-gray-800 shadow-lg md:grid-cols-3 md:divide-x md:divide-y-0">
        <div class="px-4 py-5 sm:p-6">
          <dt class="text-base font-normal text-gray-900 dark:text-gray-400">Pages with A errors</dt>
          <dd class="mt-1 flex items-baseline justify-between md:block lg:flex">
            <div class="flex items-baseline text-2xl font-semibold text-red-600">
              {{ website.stats.
                pagesWithAErrors }}
              <div class="inline-flex items-baseline rounded-full px-2.5 py-0.5 text-sm font-medium bg-red-100 text-red-800 md:mt-2 lg:mt-0">
                <span class="sr-only"> Percentage </span>
                {{ website.stats.
                  pagesWithAErrors / website.stats.
                  evaluatedPages * 100 | number: '1.0-0' }}%
              </div>
            </div>
          </dd>
        </div>
        <div class="px-4 py-5 sm:p-6">
          <dt class="text-base font-normal text-gray-900 dark:text-gray-400">Pages with AA errors</dt>
          <dd class="mt-1 flex items-baseline justify-between md:block lg:flex">
            <div class="flex items-baseline text-2xl font-semibold text-red-600">
              {{ website.stats.
                pagesWithAAErrors }}
              <div class="inline-flex items-baseline rounded-full px-2.5 py-0.5 text-sm font-medium bg-red-100 text-red-800 md:mt-2 lg:mt-0">
                <span class="sr-only"> Percentage </span>
                {{ website.stats.
                  pagesWithAAErrors / website.stats.
                  evaluatedPages * 100 | number: '1.0-0' }}%
              </div>
            </div>


          </dd>
        </div>
        <div class="px-4 py-5 sm:p-6">
          <dt class="text-base font-normal text-gray-900 dark:text-gray-400">Pages with AAA errors</dt>
          <dd class="mt-1 flex items-baseline justify-between md:block lg:flex">
            <div class="flex items-baseline text-2xl font-semibold text-red-600">
              {{ website.stats.
                pagesWithAAAErrors }}
              <div class="inline-flex items-baseline rounded-full px-2.5 py-0.5 text-sm font-medium bg-red-100 text-red-800 md:mt-2 lg:mt-0">
                <span class="sr-only"> Percentage </span>
                {{ website.stats.
                  pagesWithAAAErrors / website.stats.
                  evaluatedPages * 100 | number: '1.0-0' }}%
              </div>
            </div>


          </dd>
        </div>
      </dl>
    </div>
    </div>
    <!-- Website Pages -->
    <div>
      <div
        class="w-full md:w-3/4 lg:w-2/3 xl:w-2/3 mx-auto rounded-lg overflow-hidden shadow-lg mt-10">
        <div
          class="flex justify-between flex-row items-start bg-white dark:bg-gray-800 rounded-t-lg py-4 px-4">
          <mat-form-field>
            <mat-label> Status </mat-label>
            <mat-select [formControl]="statusFormControl">
              <mat-option
                [value]="status.value"
                *ngFor="let status of statusOptions">
                {{ status.viewValue }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <button mat-flat-button color="primary" (click)="openDialog()">
            Add Page
          </button>

        </div>
        <div class="flex flex-row items-center justify-end gap-x-4 bg-white dark:bg-gray-800 px-4">
          <button
          mat-icon-button
          color="primary"
          aria-label="Evaluate selected pages"
          [disabled]="!selection.hasValue()"
          matTooltip="Evaluate selected pages"
          matTooltipPosition="above"
          (click)="handleEvaluatePages()"
          >
            <mat-icon>pageview</mat-icon>
          </button>
          <button mat-icon-button
          color="primary"
          aria-label="Delete selected pages"
          [disabled]="!selection.hasValue()"
          matTooltip="Delete selected pages"
          matTooltipPosition="above"
          (click)="openDeletePagesDialog()"
           >
            <mat-icon>delete</mat-icon>
          </button>
        </div>
        <div class="overflow-x-auto">
          <table
            mat-table
            [dataSource]="dataSource"
            matSort
            (matSortChange)="announceSortChange($event)"
            class="mat-elevation-z8 rounded-lg dark:bg-gray-800">

            <ng-container matColumnDef="select">
              <th mat-header-cell *matHeaderCellDef>
                Select
              </th>
              <td mat-cell *matCellDef="let row">
                <mat-checkbox (click)="$event.stopPropagation()"
                              (change)="$event ? selection.toggle(row) : null"
                              [checked]="selection.isSelected(row)"
                              [aria-label]="checkboxLabel(row)">
                </mat-checkbox>
              </td>
            </ng-container>

            <ng-container matColumnDef="url">
              <th mat-header-cell *matHeaderCellDef class="dark:text-white">URL</th>
              <td mat-cell *matCellDef="let element">{{ element.url }}</td>
            </ng-container>

            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef class="dark:text-white">Status</th>
              <td mat-cell *matCellDef="let element">{{ element.status }}</td>
            </ng-container>

            <ng-container matColumnDef="lastEvaluated">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header
                sortActionDescription="Sort by evaluation date"
                class="dark:text-white">
                Last Evaluated
              </th>
              <td mat-cell *matCellDef="let element">
                {{ element.lastEvaluated | date: 'MMM d, y, h:mm:ss a' }}
              </td>
            </ng-container>

            <ng-container matColumnDef="createdAt">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header
                sortActionDescription="Sort by date added"
                class="dark:text-white">
                Date Added
              </th>
              <td mat-cell *matCellDef="let element">
                {{ element.createdAt | date: 'MMM d, y, h:mm:ss a' }}
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          </table>
        </div>
        <mat-paginator
      [pageSizeOptions]="[5, 10, 20]"
      showFirstLastButtons
      aria-label="Select page of websites pages"
      class="py-2"
      >
    </mat-paginator>
      </div>
    </div>
  </div>
</section>
